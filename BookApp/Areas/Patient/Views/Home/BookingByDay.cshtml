@model List<WebApp.Areas.Admin.Models.Department>
<!-- doccure/calendar.html  30 Nov 2019 04:12:18 GMT -->
@{
    Layout = null;
}
<head>
    <meta charset="utf-8">
    <title>Doccure</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">

    <!-- Favicons -->
    <link href="/doc_assets/img/favicon.png" rel="icon">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/doc_assets/css/bootstrap.min.css">

    <!-- Fontawesome CSS -->
    <link rel="stylesheet" href="/doc_assets/plugins/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="/doc_assets/plugins/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="/doc_assets/css/style.css">
    <link href="~/specialist/plugins/fullcalendar/fullcalendar.min.css" rel="stylesheet" />

    <style>

        .action-logout {
            background-color: #f7f8f9;
            color: #333 !important;
        }

            .action-logout .text-logout-bt {
                color: #333 !important;
                display: block;
                padding: 10px 0px 8px 10px !important;
            }

        .control-dropdown {
            margin-top: 0px;
            overflow: hidden;
            padding: 15px;
        }

        .card-body {
            position: relative
        }

        .container-fluid {
            padding-left: 20px;
            padding-right: 20px;
        }

        #close-calendar {
            position: absolute;
            bottom: 0;
            right: 2px;
        }

        .booking-right-calendar .brc-scroll-group .brc-scroll-group-2 ul li {
            padding: 8px 20px;
            border: 1px solid #307be7;
            transition: all .2s ease;
            border-radius: 2px;
            margin-right: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            text-align: center;
        }

            .booking-right-calendar .brc-scroll-group .brc-scroll-group-2 ul li a {
                color: #307be7;
                font-size: 13px;
            }

        .booking-right-calendar .brc-btn.show, #section-find-doctor-2 .booking-right-calendar .brc-btn.show {
            height: auto;
            opacity: 1;
            margin: 30px 0;
        }

        .row {
            display: flex;
            flex-wrap: wrap;
            margin-right: -15px;
            margin-left: -15px;
        }

        .btn--sm {
            padding: 0.525rem 1.125rem 0.425rem;
            line-height: 1.5;
        }

        .btn--rounded-gray {
            background: transparent;
            border: 1px solid #9ba1af !important;
            color: #7a8188 !important;
        }

        .btn--rounded-gray {
            width: 100%;
            font-weight: 700;
            transition: all 0.3s;
            position: relative;
        }

        .btn--rounded-blue {
            background: #307be7;
            border: 1px solid #307be7 !important;
            color: #fff !important;
            width: 100%;
            font-weight: 700;
            transition: all 0.3s;
            position: relative;
        }

        .btn {
            display: inline-block;
            text-decoration: none;
            text-transform: uppercase;
            text-align: center;
            font-size: 14px;
            border-radius: 2px;
            margin-right: 10px;
        }

            .btn.btn-outline-primary {
                display: inline-block;
                text-decoration: none;
                text-transform: none;
                text-align: center;
                font-size: 12px;
                border-radius: 2px;
            }

        .doc-slot-list {
            height: fit-content !important;
        }

        .booking-left-menu .booking-left-menu-top {
            margin-bottom: 20px;
            border-width: 1px;
            border-style: solid;
            border-color: rgb(205, 216, 234);
            border-image: initial;
            border-radius: 3px;
            padding: 15px;
            background: rgb(255, 255, 255);
        }

            .booking-left-menu .booking-left-menu-top .blmt-name {
                text-transform: uppercase;
                font-size: 14px;
                font-weight: bold;
                color: rgb(77, 77, 77);
                margin-bottom: 10px;
            }

            .booking-left-menu .booking-left-menu-top .blmt-info {
                font-size: 14px;
                margin-bottom: 5px;
                color: rgb(77, 77, 77);
                text-transform: capitalize;
            }

        #section-find-doctor-2 {
            margin-bottom: 20px;
        }

            #section-find-doctor-2 .find-doctor-left-1 {
                border-radius: 3px;
            }

                #section-find-doctor-2 .find-doctor-left-1 h4 {
                    color: rgb(255, 255, 255);
                    font-size: 15px;
                    padding: 15px;
                    border-radius: 3px 3px 0px 0px;
                    margin: 0px;
                    background: linear-gradient(rgb(66, 165, 245) 0px, rgb(33, 150, 243) 100%);
                }

        .find-doctor-left-1 ul {
            padding: 15px;
            border-left: 1px solid rgb(205, 216, 234);
            border-right: 1px solid rgb(205, 216, 234);
            border-bottom: 1px solid rgb(205, 216, 234);
            background: rgb(255, 255, 255);
            border-radius: 0px 0px 3px 3px;
        }

        #section-find-doctor-2 .find-doctor-left-1 ul li:first-child {
            color: rgb(48, 123, 231);
            font-weight: 700;
        }

        #section-find-doctor-2 .find-doctor-left-1 ul li {
            font-size: 13px;
            color: rgb(77, 77, 77);
            margin-bottom: 15px;
        }

            #section-find-doctor-2 .find-doctor-left-1 ul li i {
                margin-right: 15px;
                color: rgb(48, 123, 231);
            }

        li {
            list-style-type: none;
        }

        .booking-left-menu-hotline {
            margin-top: 20px;
            border-width: 1px;
            border-style: solid;
            border-color: rgb(205, 216, 234);
            border-image: initial;
            background: rgb(255, 255, 255);
            border-radius: 3px;
            padding: 20px;
        }

            .booking-left-menu-hotline .blmh-name {
                color: rgb(77, 77, 77);
                font-size: 12px;
                font-weight: bold;
                margin-bottom: 5px;
                text-transform: uppercase;
            }

            .booking-left-menu-hotline a {
                font-size: 30px;
                color: rgb(48, 123, 231);
                font-weight: bold;
                letter-spacing: 5px;
                transition: all 0.2s ease 0s;
            }

        .brc-scroll-auto {
            overflow: auto;
            height: 320px;
            padding: 0 10px;
        }


        .brc-scroll-group ul.table-ul-cont {
            border-top: 1px solid #eaeff3;
            padding: 15px 0;
            cursor: pointer;
        }

        .brc-scroll-group ul li {
            padding: 0;
            padding-right: 15px;
            font-size: 14px;
            color: #4d4d4d;
            transition: all .2s ease;
            width: 50%;
        }

        .brc-scroll-group ul.table-ul-cont li:last-child {
            text-align: left;
            display: -webkit-flex;
            display: flex;
            align-items: center;
            width: 50%;
            padding-right: 0;
        }

        .brc-scroll-group.show {
            height: auto;
            opacity: 1;
            padding: 20px 20px 0;
        }

        .search-carlendar {
            vertical-align: middle;
            padding: 0 0 20px;
        }

            .search-carlendar span {
                line-height: 39px;
                font-weight: 700;
                font-size: 12px;
                text-transform: uppercase;
            }

        .align-middle {
            vertical-align: middle !important;
        }

        .search-carlendar input {
            padding: 6px 10px 5px;
            border-radius: 2px;
        }

        .ui-widget-content {
            background: #ffffff;
            color: #222222;
        }

        .brc-scroll-group ul {
            display: flex;
            list-style-type: none;
            margin: 0;
            align-items: center;
            flex-wrap: wrap;
        }

            .brc-scroll-group ul.table-ul-cont li:last-child a {
                margin-left: auto;
                width: auto;
                padding: 4px 25px;
                display: inline-block;
                color: #4d4d4d;
                border: 1px solid #dadee5;
                font-weight: 300;
            }

            .brc-scroll-group ul li a {
                background: none;
                box-shadow: none;
                outline: none;
                border-radius: 50px !important;
                font-size: 13px;
                margin: -10px 0;
                transition: all .2s ease;
                cursor: pointer;
                text-align: center;
            }

        .selected {
            color: #fff !important;
            background-color: #307be7 !important;
            border: 1px solid #307be7 !important;
        }

        .selected1 {
            color: #fff !important;
            background-color: #307be7 !important;
            border: 1px solid #307be7 !important;
            height: 30px;
            width: 30px;
            display: flex;
            border-radius: 999px;
            z-index: 1;
            bottom: 50%;
            left: 50%;
            transform: translate(-50%,-50%);
        }

        .type.dropdown-toggle.nav-link {
            border: 1px solid;
            background: #fff;
            border-color: #307be7;
            border-radius: 99px;
            color: #307be7 !important;
            min-width: 125px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            letter-spacing: 0;
            min-height: 38px;
            font-weight: 600;
            transition: all 0.2s linear;
        }

        .fc-day-grid-event .fc-content {
            white-space: nowrap;
            overflow: hidden;
            display: flex;
            justify-content: center;
        }

        .fc-title {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 8px;
        }
        th.fc-day-header.fc-widget-header.fc-sun {
            color: #fa531f;
        }
        th.fc-day-header.fc-widget-header.fc-sat {
            color: #faa01f;
        }
    </style>
</head>
<body>

    <!-- Main Wrapper -->
    <div class="main-wrapper">

        <!-- Header -->
        <header class="header">
            <nav class="navbar navbar-expand-lg header-nav">
                <div class="navbar-header">
                    <a id="mobile_btn" href="javascript:void(0);">
                        <span class="bar-icon">
                            <span></span>
                            <span></span>
                            <span></span>
                        </span>
                    </a>
                    <a href="index-2.html" class="navbar-brand logo">
                        <img src="/specialist/img/logo.png" class="img-fluid" alt="Logo">
                    </a>
                </div>
                <div class="main-menu-wrapper">
                    <div class="menu-header">
                        <a href="index-2.html" class="menu-logo">
                            <img src="/specialist/img/logo.png" class="img-fluid" alt="Logo">
                        </a>
                        <a id="menu_close" class="menu-close" href="javascript:void(0);">
                            <i class="fas fa-times"></i>
                        </a>
                    </div>
                    <ul class="main-nav">
                        <li class="has-submenu">
                            <a href="/">Trang chủ</a>
                        </li>
                        <li class="has-submenu">
                            <a href="/Home/Intro">Giới thiệu</a>
                        </li>
                        <li class="has-submenu">
                            <a href="/Home/Quytrinh">Quy trình</a>
                        </li>
                        <li class="has-submenu">
                            <a href="/Home/Help">Hướng dẫn sử dụng</a>
                        </li>
                        <li class="has-submenu">
                            <a href="/Home/Contact">Liên hệ</a>
                        </li>
                    </ul>
                </div>
                <ul class="nav header-navbar-rht">
                    <li class="nav-item contact-item">
                        <div class="header-contact-img">
                            <i class="far fa-hospital"></i>
                        </div>
                        <div class="header-contact-detail">
                            <p class="contact-header">Liên hệ</p>
                            <p class="contact-info-header">0977129155</p>
                        </div>
                    </li>

                    @if (User.Identity.IsAuthenticated)
                    {
                        <li class="nav-item dropdown has-arrow">
                            <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
                                <span><i class="fas fa-user-circle mr-2"></i>Thông tin tài khoản</span><span class="user-img"></span>
                            </a>
                            <div class="dropdown-menu">
                                <div class="user-header">
                                    <div class="avatar avatar-sm">
                                        <img src="~/doc_assets/img/patients/user.svg" alt="User Image" class="avatar-img rounded-circle">
                                    </div>
                                    <div class="user-text">
                                        <h6>Xin chào!</h6>
                                        <p class="text-muted mb-0">@User.Identity.Name</p>
                                    </div>
                                </div>
                                <a class="dropdown-item" href="/Patient/Patients/ProfilePatient">Hồ sơ bệnh nhân</a>
                                <a class="dropdown-item" href="/Patient/Patients/ManageMB/@User.Identity.Name">Phiếu khám bệnh</a>
                                <div class="action-logout">
                                    <a class="text-logout-bt" href="/Users/Auth/SignOut">
                                        <i class="fas fa-sign-out-alt mr-2"></i>Thoát
                                    </a>
                                </div>
                            </div>
                        </li>
                        @if (User.IsInRole("Patient"))
                        {

                        }
                    }
                    else
                    {
                        <li class="nav-item">
                            <a class="nav-link header-login" href="/Users/Auth/SignIn">Đăng nhập</a>
                        </li>
                    }
                </ul>
            </nav>
        </header>
        <!-- /Header -->
        <!-- Breadcrumb -->
        <div class="breadcrumb-bar">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-md-8 col-12">
                        <nav aria-label="breadcrumb" class="page-breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="index-2.html">Trang chủ</a></li>
                                <li class="breadcrumb-item active" aria-current="page">Khám theo ngày</li>
                            </ol>
                        </nav>
                        <h3 class="breadcrumb-title">Đặt khám</h3>
                    </div>
                    <div class="col-md-4 col-12 d-md-block d-none">
                        <div class="sort-by">
                            <ul style="list-style:none">
                                <li class="nav-item dropdown has-arrow" style="list-style:none">
                                    <a href="#" class="type dropdown-toggle nav-link text-uppercase" data-toggle="dropdown">
                                        <span>Chọn hình thức đăng ký</span><span class="user-img"></span>
                                    </a>
                                    <div class="dropdown-menu text-uppercase">
                                        <a class="dropdown-item" href="/Patient/Home/BookingByDoctor">Đặt lịch theo bác sĩ</a>
                                        <hr />
                                        <a class="dropdown-item" href="/Patient/Home/BookingByDay">Đặt lịch theo ngày</a>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Breadcrumb -->
        <!-- Page Content -->
        <div class="content">
            <div class="container-fluid">

                <div class="row">

                    <!-- Calendar Events -->
                    <div class="col-md-4 col-lg-3 theiaStickySidebar">
                        <!-- Profile Sidebar -->
                        <div class="booking-left-menu shadow-2">
                            <div class="booking-left-menu-top shadow-2" id="patientDetail">

                            </div>
                            <div id="section-find-doctor-2">
                                <div class="find-doctor-left-1 shadow-2" id="doctorDetail">

                                </div>
                            </div>
                            <div class="booking-left-menu-hotline text-center shadow-2">
                                <div class="blmh-name">Hỗ trợ chuyên môn</div>
                                <a href="tel:19007178" class="d-block">19007178</a>
                                <hr>
                                <div class="blmh-name">Hỗ trợ kỹ thuật</div>
                                <a href="tel:19002115" class="d-block">19002115</a>
                            </div>
                        </div>
                    </div>
                    <!-- /Calendar Events -->
                    <!-- Calendar -->
                    <div class="col-md-6 col-lg-8 col-xl-9">
                        <div class="card">
                            <div class="card-body">
                                <div id="calender">
                                </div>
                                <div class="card-body">
                                    <a class="btn btn-outline-primary d-none" id="close-calendar">Đóng</a>
                                </div>
                                @*<div id="timeRange" class="d-none">
                                        <div class="row">
                                            <div class="col-6"><h4 class="w-100">LỊCH KHÁM BUỔI SÁNG</h4></div>
                                            <div class="col-6"><h4 class="w-100">LỊCH KHÁM BUỔI CHIỀU</h4></div>
                                        </div>
                                        <div class="row">
                                            <div class="doc-times col-6" id="timeRanges"></div>
                                            <div class="doc-times col-6" id="timeRangec"></div>
                                        </div>
                                    </div>
                                    <hr />*@
                                <div id="ds_chuyen_khoa" class="brc-scroll-group show">
                                    <div class="search-carlendar">
                                        <div class="row d-flex">
                                            <div class="col-md-3 text-title-search">
                                                <span class="align-middle">TÌM NHANH CHUYÊN KHOA</span>
                                            </div>
                                            <div class="col-md-7 search-line">
                                                <input type="text" onkeyup="filterDept(this)" name="subject_search_value" class="form-control ui-keyboard-input ui-widget-content ui-corner-all" placeholder="Tìm nhanh chuyên khoa" value="" aria-haspopup="true" role="textbox">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="brc-scroll-auto" id="deptList"></div>
                                </div>
                                <div id="confirm-thong-tin" class="brc-btn row align-items-center text-center show">
                                    <div class="col-lg-6 col-12 ml-auto">
                                        <div class="row">
                                            <div class="col-6">
                                                <a class="btn btn--rounded-gray btn--sm" href="/Patient/Home/BookingByDoctor">QUAY LẠI</a>
                                            </div>
                                            <div class="col-6">
                                                <a class="btn btn--rounded-blue btn--sm" onclick="next()">TIẾP TỤC</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- /Calendar -->

                </div>

            </div>

        </div>
        <!-- /Page Content -->
        <!-- Footer -->
        <footer class="footer">

            <!-- Footer Top -->
            <div class="footer-top">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-2 col-md-3">
                        </div>
                        <div class="col-lg-3 col-md-6">
                            <div class="footer-widget footer-about">
                                <div class="footer-logo">
                                    <img src="/doc_assets/img/footer-logo.png" alt="logo">
                                </div>
                                <div class="footer-about-content">
                                    <p>Doccure có đội ngũ chuyên gia, bác sĩ, dược sĩ và điều dưỡng trình độ chuyên môn cao, giàu kinh nghiệm. tận tâm và chuyên nghiệp. Luôn đặt người bệnh làm trung tâm, Doccure cam kết đem đến dịch vụ chăm sóc sức khỏe tốt nhất.</p>
                                    <div class="social-icon">
                                        <ul>
                                            <li>
                                                <a href="#" target="_blank"><i class="fab fa-facebook-f"></i> </a>
                                            </li>
                                            <li>
                                                <a href="#" target="_blank"><i class="fab fa-twitter"></i> </a>
                                            </li>
                                            <li>
                                                <a href="#" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                                            </li>
                                            <li>
                                                <a href="#" target="_blank"><i class="fab fa-instagram"></i></a>
                                            </li>
                                            <li>
                                                <a href="#" target="_blank"><i class="fab fa-dribbble"></i> </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-1">
                        </div>
                        <div class="col-lg-4 col-md-12">
                            <div class="footer-widget footer-contact">
                                <h2 class="footer-title">Liên hệ</h2>
                                <div class="footer-contact-info">
                                    <div class="footer-address">
                                        <span><i class="fas fa-map-marker-alt"></i></span>
                                        <p> 437c/4 Long Hòa, Bình Thủy, Cần Thơ</p>
                                    </div>
                                    <p>
                                        <i class="fas fa-phone-alt"></i>
                                        0977129155
                                    </p>
                                    <p class="mb-0">
                                        <i class="fas fa-envelope"></i>
                                        doccure@gmail.com
                                    </p>
                                </div>
                            </div>

                        </div>
                        <div class="col-lg-2 col-md-3">
                        </div>
                    </div>
                </div>
            </div>
        </footer>

        <!-- /Footer -->

    </div>
    <script src="/doc_assets/js/jquery.min.js"></script>
    <script src="~/doc_assets/js/moment.min.js"></script>
    <script src="~/doc_assets/js/bootstrap-datetimepicker.min.js"></script>
    <script src="~/doc_assets/js/fullcalendar.min.js"></script>
    <script>
        var j = jQuery.noConflict();
        var infos = null;
        var selectedEvent = null;
        var index = 0;
        j(document).ready(() => {
            infos = JSON.parse(localStorage.getItem("infos"));
            index = infos.deptType.index;
            if (!infos.info[index]) {
                infos.info.push(
                    {
                        dept: null,
                        doctor: null,
                        timeRange: null,
                        room: null,
                        edu: null,
                        dated: null
                    });
            }
            //hiện thông tin bệnh nhân bên trái
            if (infos.patient) {
                document.getElementById('patientDetail').innerHTML = `<div class="blmt-name">
                                                <div class="nav-title-name">${infos.patient?.namePatient}</div>
                                            </div>
                                            <div class="blmt-info">Địa chỉ: ${infos.patient?.addP}</div>
                                            <div class="blmt-info">Điện thoại: ${infos.patient?.phone}</div>`
            } else {
                if (confirm('Bạn chưa chọn hồ sơ, đồng ý để quay lại!') == true) {
                    window.location.href = "/patient/patients/chooseprofile";
                }
            }
            //lấy timerange
            j.ajax({
                type: "GET",
                async: false,
                url: "/Patient/home/getTimeRange",
                success: function (data) {
                    timeRange = data;
                },
                error: function (error) {
                    console.log('get tỉme range failed');
                }
            })
            FetchEventAndRenderCalendar();
        })

        function FetchEventAndRenderCalendar() {
            document.getElementById('calender').innerHTML = '';
            events = [];
            j.ajax({
                type: "GET",
                url: "/patient/home/GetScheduleAvailable",
                success: function (data) {
                    //lọc dữ liệu thừa data
                    console.log(data);
                    j.each(data, function (i, v) {
                        if (events.filter((x) => x.start == v.dated).length === 0) {
                            events.push({
                                eventID: v.id,
                                title: '',
                                description: v.description,
                                timeRange: v.timeRange,
                                ordinalRoom: v.ordinalRoom,
                                start: v.dated,
                                end: null,
                                color: '#fff',
                                allDay: true
                            });
                        }
                    })
                    GenerateCalender(events);                    
                },
                error: function (error) {
                    alert('failed');
                }
            })
        }
        function GenerateCalender(events) {
            j('#calender').fullCalendar('destroy');
            j('#calender').fullCalendar({
                monthNames: ['Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6', 'Tháng 7', 'Tháng 8', 'Tháng 9', 'Tháng 10', 'Tháng 11', 'Tháng 12'],
                monthNamesShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
                dayNames: ['CN', 'Thứ 2', 'Thứ 3', 'Thứ 4', 'Thứ 5', 'Thứ 6', 'Thứ 7'],
                dayNamesShort: ['CN', 'Thứ 2', 'Thứ 3', 'Thứ 4', 'Thứ 5', 'Thứ 6', 'Thứ 7'],
                height: 'auto',
                defaultDate: new Date(),
                timeFormat: 'h(:mm)a',
                header: {
                    left: 'prev',
                    center: 'title',
                    right: 'next'
                },
                customButtons: {
                    myCustomButton: {
                        text: 'custom!',
                        click: function () {
                            filterPastDate();
                        }
                    }
                },
                //defaultView: 'basicWeek',
                fixedWeekCount: false,
                eventLimit: false,
                eventColor: '#378006',
                events: events,
                eventClick: function (calEvent, el, jsEvent, view) {
                    let fccontents = document.getElementsByClassName('fc-content');
                    for (let fc of fccontents) {
                        fc.classList.remove('selected1');
                    }
                    j(el.target).closest('.fc-content').addClass('selected1');
                    console.log("calevent", calEvent);
                    selectedEvent = calEvent;
                    infos.info[index].dated = selectedEvent.start._i;
                    j.ajax({
                        type: 'POST',
                        data: { dated: infos.info[index].dated },
                        url: '/patient/home/GetDepartmentByDate',
                        success: function (d) {
                            console.log("deparment by dated:", d);
                            if (d.length > 0) {
                                let str = ''
                                for (let x of d) {
                                    str += `<ul class="table-ul-cont"><li>${x.deptName}</li><li>${x.price.toLocaleString(undefined, { maximumfractiondigits: 0 })} đ<a data-id='${JSON.stringify(x)}' class="chosen" onclick="deptSelect(this)"><i class="fas fa-check-circle mr-2 d-none"></i>Chọn</a></li></ul>`
                                }
                                document.getElementById('deptList').innerHTML = str;
                            }
                        }
                    })
                },
                select: function (start, end) {
                    selectedEvent = {
                        eventID: 0,
                        timeRange: '',
                        description: '',
                        start: JSON.stringify(start).slice(1, 11),
                        color: ''
                    };
                    openAddEditForm();
                    j('#calendar').fullCalendar('unselect');
                },
                initialView: 'dayGridMonth',
                validRange: function (nowDate) {
                    return {
                        start: nowDate,
                        end: nowDate.clone().add(2, 'months')
                    };
                },
                viewRender: function (view, element) {
                    var now = new Date();
                    var end = new Date();
                    end.setMonth(now.getMonth() + 1);
                    if (end < view.end) {
                        j('#calender .fc-next-button').hide();
                        return false;
                    } else {
                        j('#calender .fc-next-button').show();
                    }
                    if (view.start < now) {
                        j('#calender .fc-prev-button').hide();
                        return false;
                    } else {
                        j('#calender .fc-prev-button').show();
                    }
                },
                editable: true,
                eventDrop: function (event) {//throw dropdown, fall,
                    return false;
                }
            })
                      
            filterPastDate();
            let buttons = document.getElementsByClassName('fc-button')
            for (let button of buttons) {
                button.addEventListener('click', function () { filterPastDate() })
            }
            
        }
        function filterDept(e){
            let v = removeAccents(e.value.toUpperCase());
            console.log(v);
            let trs = document.getElementsByClassName('table-ul-cont');         
           for (var i = 0; i < trs.length; i++) {
               let text = removeAccents(trs[i].childNodes[0].innerText.toUpperCase());
               console.log(text)
                    if (text.indexOf(v)>-1 ||v==='') {
                        trs[i].style.display = "";
                    } else {
                        trs[i].style.display = "none";
                    }
            }          
        }
        function filterPastDate() {
            let rows = document.getElementsByClassName('fc-week');
            for (var i = rows.length - 1; i >= 0; i--) {
                if (rows[i].getElementsByClassName('fc-day-number').length == 0
                    && rows[i].getElementsByClassName('fc-day-header').length == 0) {
                    j(rows[i]).remove();
                }
            }
        }
        function deptSelect(e) {
            infos.info[index].dept = j(e).data('id');
            let choosen = document.getElementsByClassName('chosen');
            for (x of choosen) {
                x.classList.remove('selected');
                x.childNodes[0].classList.add('d-none');
            }
            e.classList.add('selected');
            e.childNodes[0].classList.remove('d-none');
        }

        function next() {
            if (infos.info[index].dept) {
                localStorage.setItem('infos', JSON.stringify(infos))
                window.location.href = '/Patient/Home/ChooseDoctor';
            } else {
                alert('Bạn chưa chọn chuyên khoa??')
            }
        }
        function removeAccents(str) {
            return str.normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '')
                .replace(/đ/g, 'd').replace(/Đ/g, 'D');
        }
    </script>
    @*<script src="/specialist/js/jquery.min.js"></script>*@

    <!--Bootstrap Core JS-->
    <script src="/specialist/js/popper.min.js"></script>
    <script src="/specialist/js/bootstrap.min.js"></script>

    <!-- Sticky Sidebar JS -->
    <script src="/specialist/plugins/theia-sticky-sidebar/ResizeSensor.js"></script>
    <script src="/specialist/plugins/theia-sticky-sidebar/theia-sticky-sidebar.js"></script>

    <!-- Datetimepicker JS -->
    <!--<script src="/specialist/js/moment.min.js"></script>
    <script src="/specialist/js/bootstrap-datetimepicker.min.js"></script>-->
    <!-- Full Calendar JS -->
    <!--<script src="/specialist/plugins/jquery-ui/jquery-ui.min.js"></script>
    <script src="/specialist/plugins/fullcalendar/fullcalendar.min.js"></script>
    <script src="/specialist/plugins/fullcalendar/jquery.fullcalendar.js"></script>-->
    <!-- Custom JS -->
    <script src="/specialist/js/script.js"></script>

</body>

<!-- doccure/calendar.html  30 Nov 2019 04:12:19 GMT -->
